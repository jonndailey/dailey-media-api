# Dailey Media API Environment Configuration
# IMPORTANT: Copy this file to .env and update with your values

# ============================================
# SERVER CONFIGURATION
# ============================================
# CRITICAL: Use port 4100 to avoid conflicts with other services
# Port 4000 is commonly used by other applications and will cause conflicts
NODE_ENV=development
PORT=4100  # DO NOT CHANGE to 4000 - will cause "EADDRINUSE" errors
HOST=0.0.0.0

# DAILEY CORE Integration
# Development:
DAILEY_CORE_URL=http://localhost:3002
# Production example:
# DAILEY_CORE_URL=https://core.dailey.cloud

# Database Configuration
DATABASE_URL=mysql://user:password@localhost:3306/dailey_media
DATABASE_POOL_SIZE=20

# Redis Configuration  
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# Storage Configuration
STORAGE_TYPE=s3
# Replace 127.0.0.1 with your Tailscale IP (e.g. http://100.105.97.19:9000) so other devices can connect
S3_ENDPOINT=http://127.0.0.1:9000
S3_REGION=us-east-1
S3_BUCKET=dailey-media
S3_ACCESS_KEY_ID=dailey
S3_SECRET_ACCESS_KEY=dailey-secret
S3_FORCE_PATH_STYLE=
S3_PUBLIC_BUCKET=dailey-media-public

# MinIO Local Development
MINIO_ROOT_USER=dailey
MINIO_ROOT_PASSWORD=dailey-secret
MINIO_ADDRESS=:9000
MINIO_CONSOLE_ADDRESS=:9001
MINIO_DATA_DIR=./.minio/data
MINIO_CONFIG_DIR=./.minio/config

# Security Configuration
JWT_SECRET=your-super-secure-secret-change-this-in-production
JWT_EXPIRY=1h
JWT_REFRESH_EXPIRY=7d
BCRYPT_ROUNDS=12

# Legacy JWT Configuration (DAILEY CORE)
# Development defaults point to dev Core. For production, use the cloud domain
# to allow local JWKS verification even if Core is temporarily unreachable.
CORE_JWKS_URL=https://core.dailey.dev/.well-known/jwks.json
JWT_ISSUER=https://core.dailey.dev
JWT_AUDIENCE=dailey-media-api
# Production example:
# CORE_JWKS_URL=https://core.dailey.cloud/.well-known/jwks.json
# JWT_ISSUER=https://core.dailey.cloud
# JWT_AUDIENCE=dailey-media-api

# CORS Configuration
# IMPORTANT: Include all frontend URLs and your Tailscale IP
# Replace 100.105.97.19 with your actual Tailscale IP
CORS_ORIGINS=http://localhost:3000,http://localhost:5174,http://100.105.97.19:5174

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
AUTH_RATE_LIMIT_REQUESTS=5
UPLOAD_RATE_LIMIT_REQUESTS=10
API_RATE_LIMIT_REQUESTS=1000

# File Processing
MAX_FILE_SIZE=104857600
ALLOWED_FORMATS=jpg,jpeg,png,gif,webp,heic,heif,avif,tiff,cr2,cr3,nef,arw,dng
VARIANT_SIZES=sm:640,md:1280,lg:1920
MAX_FILES_PER_UPLOAD=10
THUMBNAIL_QUALITY=80

# OCR Configuration
OCR_SUPPORTED_LANGUAGES=eng,spa,fra,deu,ita,por,nld,pol,swe,fin,tur,jpn,chi_sim
OCR_DEFAULT_LANGUAGES=eng,spa
OCR_MAX_LANGUAGES=3
OCR_ENABLE_SEARCHABLE_PDF=true
OCR_ENABLE_STRUCTURED_DATA=true

# Document Conversion
LIBREOFFICE_BINARY=
CONVERSION_SUPPORTED_MAP=
CONVERSION_MAX_BATCH=10
CONVERSION_ENABLE_WATERMARKING=true
CONVERSION_DEFAULT_WATERMARK=
CONVERSION_ENABLE_COMPRESSION=true
CONVERSION_ENABLE_SECURITY=true

# Video Processing
VIDEO_PROCESSING_ENABLED=false
VIDEO_PROCESSING_QUEUE=video-processing
VIDEO_PROCESSING_CONCURRENCY=1
FFMPEG_PATH=
FFPROBE_PATH=
VIDEO_DEFAULT_OUTPUTS=
VIDEO_WEBHOOK_MAX_RETRIES=3
VIDEO_WEBHOOK_TIMEOUT=5000
VIDEO_PROGRESS_UPDATE_INTERVAL=2000
VIDEO_WEBHOOKS_ENABLED=true
VIDEO_ALLOW_ORIGINAL=false

# Monitoring and Logging
LOG_LEVEL=info
METRICS_ENABLED=true
SENTRY_DSN=
NEW_RELIC_LICENSE_KEY=

# SSL/TLS Configuration
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem
FORCE_HTTPS=true

# Performance Configuration
COMPRESSION_LEVEL=6
CACHE_TTL=3600
MAX_CONCURRENT_UPLOADS=50

# CDN Configuration
CDN_URL=https://cdn.dailey.dev

# Development Settings
DEBUG_MODE=false
ENABLE_DEBUG_ROUTES=false
DISABLE_AUTH=true  # Set to true for development to bypass authentication

# Frontend Development (Vite)
# Update with your Tailscale IP for remote access
VITE_MEDIA_API_URL=http://100.105.97.19:4100
